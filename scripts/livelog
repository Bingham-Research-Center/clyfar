#!/usr/bin/env bash
set -euo pipefail
# Append timestamped notes or piped content to docs/session_log.md

ROOT_DIR=$(git rev-parse --show-toplevel 2>/dev/null || true)
if [ -z "$ROOT_DIR" ] || [ ! -d "$ROOT_DIR/docs" ]; then
  # Silently succeed if not in a repo with docs/
  exit 0
fi

LOG="$ROOT_DIR/docs/session_log.md"
{
  printf "\n## %s UTC\n\n" "$(date -u +"%F %T")"
  if [ -t 0 ]; then
    printf "%s\n" "$*"
  else
    cat
  fi
} >> "$LOG" 2>/dev/null || true

>&2 echo "Appended to $LOG"
